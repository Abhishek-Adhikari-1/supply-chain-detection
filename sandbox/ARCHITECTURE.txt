```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    SUPPLY CHAIN GUARDIAN - SANDBOX ARCHITECTURE              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

                         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                         â”‚   Backend / CLI      â”‚
                         â”‚  (Analysis Request)  â”‚
                         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                    â”‚
                                    â–¼
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚   Sandbox Controller (Python) â”‚
                    â”‚   â€¢ Manages Docker containers â”‚
                    â”‚   â€¢ Handles results           â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                â”‚
                                â”‚ Docker API
                                â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚          DOCKER CONTAINER (Isolated)          â”‚
        â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
        â”‚  â”‚         Sandbox Runner (Main)           â”‚  â”‚
        â”‚  â”‚  â€¢ Installs package dependencies        â”‚  â”‚
        â”‚  â”‚  â€¢ Executes package code                â”‚  â”‚
        â”‚  â”‚  â€¢ Coordinates monitors                 â”‚  â”‚
        â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
        â”‚                â”‚              â”‚                â”‚
        â”‚       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”        â”‚
        â”‚       â”‚  Network    â”‚  â”‚   File     â”‚        â”‚
        â”‚       â”‚  Monitor    â”‚  â”‚  Monitor   â”‚        â”‚
        â”‚       â”‚             â”‚  â”‚            â”‚        â”‚
        â”‚       â”‚ â€¢ netstat   â”‚  â”‚ â€¢ watchdog â”‚        â”‚
        â”‚       â”‚ â€¢ tcpdump   â”‚  â”‚ â€¢ strace   â”‚        â”‚
        â”‚       â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜        â”‚
        â”‚                â”‚              â”‚                â”‚
        â”‚                â–¼              â–¼                â”‚
        â”‚        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”‚
        â”‚        â”‚   Package Under Test     â”‚           â”‚
        â”‚        â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚           â”‚
        â”‚        â”‚   â”‚   npm install    â”‚   â”‚           â”‚
        â”‚        â”‚   â”‚   node index.js  â”‚   â”‚           â”‚
        â”‚        â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚           â”‚
        â”‚        â”‚                          â”‚           â”‚
        â”‚        â”‚   Tries to:              â”‚           â”‚
        â”‚        â”‚   âŒ Connect to evil IP  â”‚           â”‚
        â”‚        â”‚   âŒ Access ~/.ssh       â”‚           â”‚
        â”‚        â”‚   âŒ Read .env file      â”‚           â”‚
        â”‚        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚
        â”‚                                                â”‚
        â”‚  Results Flow:                                â”‚
        â”‚  1. Execution logs â†’ /sandbox/results/        â”‚
        â”‚  2. Network logs   â†’ /sandbox/logs/           â”‚
        â”‚  3. File logs      â†’ /sandbox/logs/           â”‚
        â”‚                                                â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
                             â–¼
                â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                â”‚   Behavior Analyzer        â”‚
                â”‚   â€¢ Parses all logs        â”‚
                â”‚   â€¢ Calculates risk score  â”‚
                â”‚   â€¢ Generates report       â”‚
                â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
                             â–¼
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚         ANALYSIS REPORT (JSON)             â”‚
        â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
        â”‚  {                                         â”‚
        â”‚    "risk_score": 96,                       â”‚
        â”‚    "threat_level": "CRITICAL",             â”‚
        â”‚    "verdict": "MALICIOUS",                 â”‚
        â”‚    "findings": [                           â”‚
        â”‚      {                                     â”‚
        â”‚        "severity": "critical",             â”‚
        â”‚        "type": "suspicious_ip",            â”‚
        â”‚        "message": "Connected to           â”‚
        â”‚                   45.142.212.61"           â”‚
        â”‚      },                                    â”‚
        â”‚      {                                     â”‚
        â”‚        "severity": "critical",             â”‚
        â”‚        "type": "ssh_access",               â”‚
        â”‚        "message": "Attempted to access    â”‚
        â”‚                   SSH keys"                â”‚
        â”‚      }                                     â”‚
        â”‚    ],                                      â”‚
        â”‚    "recommendations": [                    â”‚
        â”‚      "ðŸš¨ BLOCK this package immediately", â”‚
        â”‚      "ðŸ” Report to registry"              â”‚
        â”‚    ]                                       â”‚
        â”‚  }                                         â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚
                     â–¼
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚  Backend Decision Engine   â”‚
        â”‚  â€¢ Risk >= 70 â†’ BLOCK      â”‚
        â”‚  â€¢ Risk 40-69 â†’ REVIEW     â”‚
        â”‚  â€¢ Risk < 40  â†’ ALLOW      â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜


SECURITY LAYERS
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Layer 1: Network Isolation (--network none)                â”‚
â”‚   â”œâ”€ No internet access                                    â”‚
â”‚   â”œâ”€ No communication with host                            â”‚
â”‚   â””â”€ Monitors track connection attempts (blocked)          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Layer 2: Filesystem Isolation                              â”‚
â”‚   â”œâ”€ Package mounted read-only (:ro)                       â”‚
â”‚   â”œâ”€ No access to host filesystem                          â”‚
â”‚   â””â”€ Limited writable directories                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Layer 3: Privilege Restriction                             â”‚
â”‚   â”œâ”€ Non-root user (sandbox:sandbox)                       â”‚
â”‚   â”œâ”€ Capabilities dropped (--cap-drop=ALL)                 â”‚
â”‚   â””â”€ No privilege escalation (--security-opt)              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Layer 4: Resource Limits                                   â”‚
â”‚   â”œâ”€ CPU/Memory limits (optional)                          â”‚
â”‚   â”œâ”€ Execution timeout (kills runaway processes)           â”‚
â”‚   â””â”€ Disk space constraints                                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜


MONITORING FLOW
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Package Execution Timeline:
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

T=0s      Start monitors
          â”œâ”€ Network Monitor: Poll netstat every 500ms
          â””â”€ File Monitor: Watch filesystem with watchdog

T=1s      Install dependencies
          â””â”€ Monitor captures: npm registry connections (safe)

T=5s      Execute package
          â”œâ”€ Package tries: fetch('http://45.142.212.61')
          â”‚  â””â”€ Network Monitor: ðŸš¨ DETECTED suspicious IP
          â”œâ”€ Package tries: fs.readFile('/home/.ssh/id_rsa')
          â”‚  â””â”€ File Monitor: ðŸš¨ DETECTED SSH access attempt
          â””â”€ Package tries: process.env.API_KEY
             â””â”€ Execution Monitor: ðŸš¨ DETECTED in stdout

T=30s     Timeout reached â†’ Kill process

T=31s     Stop monitors & collect logs

T=32s     Behavior Analyzer runs
          â”œâ”€ Parse network logs â†’ +35 points (suspicious IP)
          â”œâ”€ Parse file logs    â†’ +25 points (SSH access)
          â””â”€ Total risk: 96/100 (CRITICAL)

T=33s     Generate report & return to controller


DATA FLOW
â•â•â•â•â•â•â•â•â•

Logs Directory Structure:
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

sandbox/
â”œâ”€â”€ results/
â”‚   â”œâ”€â”€ auth-helper_1737234567_result.json    â† Execution logs
â”‚   â””â”€â”€ auth-helper_1737234567_analysis.json  â† Final report
â””â”€â”€ logs/
    â”œâ”€â”€ auth-helper_1737234567_network.json   â† Network activity
    â””â”€â”€ auth-helper_1737234567_files.json     â† File operations


Example Network Log:
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

{
  "connections": [
    {
      "protocol": "tcp",
      "remote_ip": "45.142.212.61",
      "remote_port": "443",
      "timestamp": "2026-01-19T10:30:45"
    }
  ],
  "suspicious_ips": ["45.142.212.61"]
}


Example File Log:
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

{
  "events": [
    {
      "type": "created",
      "path": "/home/.ssh/id_rsa.backup",
      "suspicious": true,
      "timestamp": "2026-01-19T10:30:47"
    }
  ],
  "analysis": {
    "threat_indicators": {
      "accesses_ssh": true,
      "accesses_env": true
    }
  }
}


USAGE PATTERNS
â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Pattern 1: CLI Testing
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
$ ./run_sandbox.sh sus_packages/auth-helper npm 30
    â†“
Docker container created & executed
    â†“
Results printed to console
    â†“
JSON files saved to sandbox/results/


Pattern 2: Python API
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
from sandbox_controller import SandboxController

sandbox = SandboxController()
result = sandbox.test_package('sus_packages/auth-helper', 'npm')
    â†“
Returns: {'risk_score': 96, 'verdict': 'MALICIOUS', ...}


Pattern 3: Backend Integration
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Backend receives package update notification
    â†“
Static analysis: Risk score 75 (CRITICAL)
    â†“
Trigger sandbox: sandbox.test_package(...)
    â†“
Sandbox result: Risk score 96 (CRITICAL)
    â†“
Combined decision: BLOCK
    â†“
Dashboard alert + Email notification


RISK CALCULATION
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Network Risk (max 50):
  â”œâ”€ Each connection: +15
  â””â”€ Each suspicious IP: +35

File Risk (max 50):
  â”œâ”€ Sensitive file access: +30
  â”œâ”€ SSH access: +25
  â”œâ”€ Environment access: +20
  â””â”€ File deletion: +10

Execution Risk (max 20):
  â”œâ”€ Timeout: +15
  â””â”€ Errors: +5

Total = min(network + file + execution, 100)


Example Calculation for auth-helper:
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Network: 1 suspicious IP = 35
File: SSH access + env access = 25 + 20 = 45
Execution: Normal = 0
Total: 35 + 45 + 0 = 80 â†’ CRITICAL
```
